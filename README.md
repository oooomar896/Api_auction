# ูุธุงู ููุงุชูุญ API - Module API Data

## ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ููุงุชูุญ API ูู ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ูุชุฃููู ุงููุตูู ุฅูู API ูู ูุญุฏุฉ Module API Data. ูููุฑ ุงููุธุงู ุฅุฏุงุฑุฉ ุดุงููุฉ ูููุงุชูุญ API ูุน ููุฒุงุช ุฃูุงู ูุชูุฏูุฉ.

## ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ ุฃููุงุน ููุงุชูุญ API
- **ููุชุงุญ ุนุงู (Public)**: ูููุตูู ุงูุนุงู ุงููุญุฏูุฏ
- **ููุชุงุญ ุฎุงุต (Private)**: ูููุตูู ุงููุงูู
- **ููุชุงุญ ูุคูุช (Temporary)**: ูุน ุงูุชูุงุก ุตูุงุญูุฉ ุชููุงุฆู
- **ููุชุงุญ ุฅุฏุงุฑู (Admin)**: ูููุตูู ุงูุฅุฏุงุฑู ุงููุงูู

### ๐ก๏ธ ููุฒุงุช ุงูุฃูุงู
- **ุชุฌุฒุฆุฉ ุขููุฉ**: ุชุฎุฒูู ููุงุชูุญ API ูุดูุฑุฉ
- **ุชุญูู ูู IP**: ุชูููุฏ ุงููุตูู ูุนูุงููู IP ูุญุฏุฏุฉ
- **ุชุญูู ูู ุงูููุงุท ุงูููุงุฆูุฉ**: ุชูููุฏ ุงููุตูู ูููุงุท ููุงุฆูุฉ ูุญุฏุฏุฉ
- **ุญุฏ ุงูุงุณุชุฎุฏุงู**: ุชุญุฏูุฏ ุนุฏุฏ ูุฑุงุช ุงูุงุณุชุฎุฏุงู ุงููุณููุญุฉ
- **ุงูุชูุงุก ุตูุงุญูุฉ ุชููุงุฆู**: ุฅูุบุงุก ููุงุชูุญ ููุชููุฉ ุงูุตูุงุญูุฉ

### ๐ ุงููุฑุงูุจุฉ ูุงูุชุชุจุน
- **ุชุชุจุน ุงูุงุณุชุฎุฏุงู**: ุชุณุฌูู ูู ุงุณุชุฎุฏุงู ูููุชุงุญ API
- **ุฅุญุตุงุฆูุงุช ููุตูุฉ**: ุฅุญุตุงุฆูุงุช ุดุงููุฉ ูุงุณุชุฎุฏุงู ุงูููุงุชูุญ
- **ุณุฌู ุงูุฃูุงู**: ุชุณุฌูู ุฌููุน ูุญุงููุงุช ุงููุตูู
- **ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ**: ุฅุดุนุงุฑุงุช ุนูุฏ ุงูุชูุงุก ุตูุงุญูุฉ ุงูููุงุชูุญ

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุฅูุดุงุก ููุชุงุญ API ุฌุฏูุฏ

```python
from odoo import api, SUPERUSER_ID

env = api.Environment(cr, SUPERUSER_ID, {})

# ุฅูุดุงุก ููุชุงุญ API ุฌุฏูุฏ
api_key = env['api.key'].create({
    'name': 'ููุชุงุญ API ููุชุทุจูู ุงูุฎุงุฑุฌู',
    'user_id': user_id,
    'key_type': 'private',
    'permissions': 'write',
    'expires_at': '2024-12-31 23:59:59',
    'max_usage': 1000,
    'allowed_ips': '192.168.1.1\n10.0.0.1',
    'allowed_endpoints': '/api/v1/products\n/api/v1/sellers',
    'description': 'ููุชุงุญ API ููุชุทุจูู ุงูุฎุงุฑุฌู'
})
```

### ุงูุชุญูู ูู ุตุญุฉ ููุชุงุญ API

```python
from utils.api_key_validator import ApiKeyValidator

validator = ApiKeyValidator(env)

# ุงูุชุญูู ูู ุตุญุฉ ุงูููุชุงุญ
is_valid, message, api_key = validator.validate_api_key(
    api_key_value='your_api_key_here',
    ip_address='192.168.1.1',
    endpoint='/api/v1/products'
)

if is_valid:
    print("ุงูููุชุงุญ ุตุญูุญ")
else:
    print(f"ุฎุทุฃ: {message}")
```

### ุงูุญุตูู ุนูู ุตูุงุญูุงุช ููุชุงุญ API

```python
permissions = validator.get_api_key_permissions('your_api_key_here')

if permissions:
    print(f"ููุน ุงูููุชุงุญ: {permissions['key_type']}")
    print(f"ุงูุตูุงุญูุงุช: {permissions['permissions']}")
    print(f"ุงูููุงุท ุงูููุงุฆูุฉ ุงููุณููุญุฉ: {permissions['allowed_endpoints']}")
```

## ุฅุฏุงุฑุฉ ููุงุชูุญ API

### ุชูุนูู ููุชุงุญ API
```python
api_key.action_activate()
```

### ุชุนููู ููุชุงุญ API
```python
api_key.action_suspend()
```

### ุฅูุบุงุก ููุชุงุญ API
```python
api_key.action_revoke()
```

### ุฅุนุงุฏุฉ ุชูููุฏ ููุชุงุญ API
```python
api_key.action_regenerate()
```

## ุงูููุงู ุงูุฏูุฑูุฉ

### ุงูุชุญูู ูู ููุงุชูุญ API ููุชููุฉ ุงูุตูุงุญูุฉ
ุงููุธุงู ูุญุชูู ุนูู ูููุฉ ุฏูุฑูุฉ ุชุนูู ููููุงู ููุชุญูู ูู ููุงุชูุญ API ููุชููุฉ ุงูุตูุงุญูุฉ ูุชุญุฏูุซ ุญุงูุชูุง ุชููุงุฆูุงู.

```python
# ุงููููุฉ ุงูุฏูุฑูุฉ
def _cron_check_expired_keys(self):
    expired_keys = self.search([
        ('state', '=', 'active'),
        ('expires_at', '!=', False),
        ('expires_at', '<', fields.Datetime.now())
    ])
    
    for key in expired_keys:
        key.write({'state': 'expired', 'is_active': False})
```

## ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ูุงุฆูุฉ ููุงุชูุญ API
- ุนุฑุถ ุฌููุน ููุงุชูุญ API ูุน ุญุงูุชูุง
- ููุชุฑุฉ ุญุณุจ ุงูููุน ูุงูุญุงูุฉ
- ุจุญุซ ูุชูุฏู
- ุชุฌููุน ุญุณุจ ุงููุณุชุฎุฏู ูุงูููุน

### ูููุฐุฌ ููุชุงุญ API
- ุนุฑุถ ุชูุตููู ูููุชุงุญ API
- ุฅุฏุงุฑุฉ ุงูุญุงูุฉ (ุชูุนูู/ุชุนููู/ุฅูุบุงุก)
- ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงูุงุณุชุฎุฏุงู
- ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช ูุงููููุฏ

### ููุฒุงุฑุฏ ุฅูุบุงุก ููุชุงุญ API
- ูุงุฌูุฉ ุณููุฉ ูุฅูุบุงุก ููุงุชูุญ API
- ุฅุฏุฎุงู ุณุจุจ ุงูุฅูุบุงุก
- ุฎูุงุฑ ุฅุดุนุงุฑ ุงููุณุชุฎุฏู

## ุงูุฃูุงู

### ุชุฎุฒูู ุขูู
- ููุงุชูุญ API ูุดูุฑุฉ ุจุงุณุชุฎุฏุงู SHA-256
- ูุง ูุชู ุนุฑุถ ุงูููุงุชูุญ ุงูุฃุตููุฉ ูู ุงููุงุฌูุฉ
- ุชุฎุฒูู ุขูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุชุญูู ุงููุชุนุฏุฏ ุงููุณุชููุงุช
1. **ุงูุชุญูู ูู ุงูุชุฌุฒุฆุฉ**: ููุงุฑูุฉ ุชุฌุฒุฆุฉ ุงูููุชุงุญ
2. **ุงูุชุญูู ูู ุงูุญุงูุฉ**: ุงูุชุฃูุฏ ูู ุฃู ุงูููุชุงุญ ูุดุท
3. **ุงูุชุญูู ูู ุงูุชูุงุก ุงูุตูุงุญูุฉ**: ุงูุชุฃูุฏ ูู ุนุฏู ุงูุชูุงุก ุงูุตูุงุญูุฉ
4. **ุงูุชุญูู ูู ุนุฏุฏ ูุฑุงุช ุงูุงุณุชุฎุฏุงู**: ุงูุชุฃูุฏ ูู ุนุฏู ุชุฌุงูุฒ ุงูุญุฏ
5. **ุงูุชุญูู ูู ุนููุงู IP**: ุงูุชุฃูุฏ ูู ุฃู IP ูุณููุญ
6. **ุงูุชุญูู ูู ุงูููุทุฉ ุงูููุงุฆูุฉ**: ุงูุชุฃูุฏ ูู ุฃู ุงูููุทุฉ ูุณููุญุฉ

### ุชุณุฌูู ุงูุฃูุงู
- ุชุณุฌูู ุฌููุน ูุญุงููุงุช ุงููุตูู
- ุชุณุฌูู ุงูุฃุฎุทุงุก ูุงููุญุงููุงุช ุงููุงุดูุฉ
- ุชุชุจุน ุงุณุชุฎุฏุงู ูู ููุชุงุญ API

## ุงูุฅุญุตุงุฆูุงุช

### ุฅุญุตุงุฆูุงุช ููุงุชูุญ API
```python
stats = validator.get_api_key_stats(user_id=user_id)

print(f"ุฅุฌูุงูู ุงูููุงุชูุญ: {stats['total']}")
print(f"ุงูููุงุชูุญ ุงููุดุทุฉ: {stats['active']}")
print(f"ุงูููุงุชูุญ ุงููุนููุฉ: {stats['suspended']}")
print(f"ุงูููุงุชูุญ ููุชููุฉ ุงูุตูุงุญูุฉ: {stats['expired']}")
print(f"ุฅุฌูุงูู ุงูุงุณุชุฎุฏุงู: {stats['total_usage']}")
```

## ุงูุชูุงูู ูุน API

### ุงุณุชุฎุฏุงู ูู Controllers
```python
from odoo import http
from odoo.http import request
from utils.api_key_validator import ApiKeyValidator

class ApiController(http.Controller):
    
    @http.route('/api/v1/products', type='http', auth='none', methods=['GET'])
    def get_products(self, **kwargs):
        # ุงูุญุตูู ุนูู ููุชุงุญ API ูู ุงูุทูุจ
        api_key = request.httprequest.headers.get('Authorization', '').replace('Bearer ', '')
        
        # ุงูุชุญูู ูู ุตุญุฉ ุงูููุชุงุญ
        validator = ApiKeyValidator(request.env)
        is_valid, message, api_key_record = validator.validate_api_key(
            api_key, 
            request.httprequest.remote_addr,
            '/api/v1/products'
        )
        
        if not is_valid:
            return json.dumps({'error': message}), 401
        
        # ุชุณุฌูู ุงูุงุณุชุฎุฏุงู
        validator.log_api_usage(
            api_key, 
            '/api/v1/products', 
            request.httprequest.remote_addr,
            request.httprequest.headers.get('User-Agent'),
            success=True
        )
        
        # ุชูููุฐ ุงูุทูุจ
        products = request.env['module_api_data.product'].search([])
        return json.dumps([{
            'id': p.id,
            'name': p.name,
            'code': p.code,
            'price': p.price
        } for p in products])
```

## ุงูุตูุงุญูุงุช

### ุตูุงุญูุงุช ุงููุณุชุฎุฏููู
- **ุงููุณุชุฎุฏู ุงูุนุงุฏู**: ุฅูุดุงุก ูุฅุฏุงุฑุฉ ููุงุชูุญ API ุงูุฎุงุตุฉ ุจู
- **ูุฏูุฑ ุงููุธุงู**: ุฅุฏุงุฑุฉ ุฌููุน ููุงุชูุญ API ูุฅูุดุงุก ููุงุชูุญ ุฅุฏุงุฑูุฉ

### ุฃููุงุน ุงูุตูุงุญูุงุช
- **ูุฑุงุกุฉ ููุท (read)**: ุงููุตูู ูููุฑุงุกุฉ ููุท
- **ูุฑุงุกุฉ ููุชุงุจุฉ (write)**: ุงููุตูู ูููุฑุงุกุฉ ูุงููุชุงุจุฉ
- **ุฅุฏุงุฑุฉ ูุงููุฉ (admin)**: ุงููุตูู ุงููุงูู ูุฌููุน ุงููุธุงุฆู

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ ูุญููููุง

#### 1. ููุชุงุญ API ุบูุฑ ุตุญูุญ
- **ุงูุณุจุจ**: ุงูููุชุงุญ ุบูุฑ ููุฌูุฏ ุฃู ุบูุฑ ูุดุท
- **ุงูุญู**: ุงูุชุญูู ูู ุตุญุฉ ุงูููุชุงุญ ูุญุงูุชู

#### 2. ุนููุงู IP ุบูุฑ ูุณููุญ
- **ุงูุณุจุจ**: ุนููุงู IP ุงููุณุชุฎุฏู ุบูุฑ ูุฏุฑุฌ ูู ุงููุงุฆูุฉ ุงููุณููุญุฉ
- **ุงูุญู**: ุฅุถุงูุฉ ุนููุงู IP ุฅูู ูุงุฆูุฉ ุงูุนูุงููู ุงููุณููุญุฉ

#### 3. ุงูููุทุฉ ุงูููุงุฆูุฉ ุบูุฑ ูุณููุญุฉ
- **ุงูุณุจุจ**: ุงูููุทุฉ ุงูููุงุฆูุฉ ุงููุทููุจุฉ ุบูุฑ ูุฏุฑุฌุฉ ูู ุงููุงุฆูุฉ ุงููุณููุญุฉ
- **ุงูุญู**: ุฅุถุงูุฉ ุงูููุทุฉ ุงูููุงุฆูุฉ ุฅูู ูุงุฆูุฉ ุงูููุงุท ุงููุณููุญุฉ

#### 4. ุงูุชูุงุก ุตูุงุญูุฉ ุงูููุชุงุญ
- **ุงูุณุจุจ**: ุงูููุชุงุญ ููุชูู ุงูุตูุงุญูุฉ
- **ุงูุญู**: ุฅูุดุงุก ููุชุงุญ ุฌุฏูุฏ ุฃู ุชูุฏูุฏ ุตูุงุญูุฉ ุงูููุชุงุญ ุงูุญุงูู

#### 5. ุชุฌุงูุฒ ุญุฏ ุงูุงุณุชุฎุฏุงู
- **ุงูุณุจุจ**: ุชู ุงุณุชููุงุฐ ุนุฏุฏ ูุฑุงุช ุงูุงุณุชุฎุฏุงู ุงููุณููุญุฉ
- **ุงูุญู**: ุฒูุงุฏุฉ ุญุฏ ุงูุงุณุชุฎุฏุงู ุฃู ุฅูุดุงุก ููุชุงุญ ุฌุฏูุฏ

## ุงูุชุทููุฑ ุงููุณุชูุจูู

### ููุฒุงุช ููุชุฑุญุฉ
- **JWT Tokens**: ุฏุนู JWT tokens ููุชุญูู ูู ุงููููุฉ
- **Rate Limiting**: ุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช ููู ููุชุงุญ
- **Webhook Support**: ุฏุนู webhooks ููุฅุดุนุงุฑุงุช
- **API Analytics**: ุชุญูููุงุช ูุชูุฏูุฉ ูุงุณุชุฎุฏุงู API
- **Multi-factor Authentication**: ุฏุนู ุงููุตุงุฏูุฉ ูุชุนุฏุฏุฉ ุงูุนูุงูู

### ุชุญุณููุงุช ุงูุฃูุงู
- **Encryption at Rest**: ุชุดููุฑ ุงูููุงุชูุญ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **Key Rotation**: ุฏูุฑุงู ุชููุงุฆู ููููุงุชูุญ
- **Audit Trail**: ุณุฌู ุชุฏููู ููุตู
- **Threat Detection**: ูุดู ุงูุชูุฏูุฏุงุช ูุงููุฌูุงุช

## ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ูููุณุงุนุฏุฉ ูุงูุฏุนู ุงูุชูููุ ูุฑุฌู ุงูุชูุงุตู ูุน ูุฑูู ุงูุชุทููุฑ ุฃู ูุฑุงุฌุนุฉ ุงููุซุงุฆู ุงูุชูููุฉ.

---

**ููุงุญุธุฉ**: ูุฐุง ุงููุธุงู ูุตูู ูุชูููุฑ ุฃูุงู ุนุงูู ููุฑููุฉ ูู ุฅุฏุงุฑุฉ ููุงุชูุญ API. ูุฑุฌู ุงุชุจุงุน ุฃูุถู ุงูููุงุฑุณุงุช ุงูุฃูููุฉ ุนูุฏ ุงุณุชุฎุฏุงูู. 
